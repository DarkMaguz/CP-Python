#!/usr/bin/python3
"""
  challenge01.py

    Created on: Mar 29, 2025
        Author: Peter "Magnus" Balling
        License: MIT
  This is a game of life!
  The goal is to extract the "encpryptedMessage".
"""

import dmca
import zlib
import time
import hashlib

encpryptedMessage = bytearray(b'f\x17\xeb\xa3\xc3\xd6\x170KV6\x9a\x19\xee\x08b\xc6\x80Lo\xc3 BY\xd1.#3\xe4\xbe\x00;\xe7\xf5\x12\x18\xafB\xdfH\x16Y%\x8d\t\x89J\x80I\x10\xcdl\xc4\xa7\x06}\xc6L@\x17\x92"\x87\x96\x9a>\xe6(\x97\xe3"\xaa\x82\xc7\xd1\xf7\x1b\xcb\xe8\x9d6\xdf\xae$\x92\x0b\x91\xf8\xe6\xb7\xa6\xfa\x86\xff\xc7BM\x03\xa5\x8f\x88\xba\x9csS?\xa2{_e\x99\xf6\xa3\x1c\xdfT\x1ef\xa4;#f\xf9\x11\x88b\xe8\xf1\xf7\xc2\xb2\xac1S\x06kN\xcbp\x8d\xb4\xbc\xae]\x1e\xab(\xa2\x86\xfb(\x97\xe75z\x8f-\x1c\xe7\xe0\xee\x8c\xda\xc8\x88\x12\xc5J\x0cl\xfc\x8cr_\xe8\x13T4@\xfcl\xe8=\x981\xd5v\xf8\xa3\xf7\x94\xed\x07M\x9ag\xa4\xb9q\xd6\xe9/\x17D\xff\x0cY\xa4\x80i\x85\xe1\xb2\xba@Fk\x8d\xf2\x0c\xac\xd6\xa55[\x0b\xa43\xa2\x0c \xf6\xc4\xd2\xe4)\xcc\x94\x86\xb3P\r+\x94\x06\x0b\xbe\x14\xa8U\x0e\x97\x1a]\xbeCb\x12,Evq\x11\x1a\xb2\x13j\\\xd4\xa5\xb1\x16\xd3\xbb\x87\x91\x04L\x13\xdfy\xf4\x1f\x80\xe8\x87\xad\xdaWn\x8d\x0c\xb6\xadY_#\xe5y\xa6\xd3\xa2\xe7\x01\x9d\x19\x86\x8d=\xc8{M\xba\xfe\xf3&\x05n.QW_\xda\x9b\xb6Q;X\xf2\xe9\x12=\xcbC\t\xe8^\x83e\xc7\x9av~\x9c\x8f\x1d\x89\xd4\x9eD\x8fx\xb1\xf4Lz\tHW8\x06z\xf1VJ\xda\x93\xf1\xed8\xa3M\x9d^\xcd\x12\xba\xf2\xdf\'x|!\xf2\xcb\xfb\x1d\x9a\'\xfa\x8c\'(\xa8\xd4\xe1\x02\x02\x16\x1f\xf3\xdfS\xc2e\x97^5\xcc\xeb\xda\xfb\xf7\x8d\xecM\xb6d\x043[\xf2\xf1\x02V\x853\xec\xff&b\xe8\xda\xb4\xfb\xa5b\xa6\xd3\xd6\x9f5*\n\xff\xc8\xfa4\xd61jk\xfe\xfax\xf9\xac\x8a\xa8\x0fi\xf6\xa6\xbb\xfaMj9+<\x83\xa4\x99%\x12\x1eq\x90/\x83\x06oY\x0c\x04/\'\xa2\xc8\xd4x^\x07h\xa4#\xac\xa9\xe4r\x7f/\xfb\xff\xf6.\xd7\xf2\xfc\xd6MD\xbfhD\n\xe5\x9b)\x12\xe6X#\xa1M\xa3\xf8\xc2\x7f\x97\x99\xaaNHt\xc2\xacm\xfe\x81S\x0bf\x03m:\x91\n7(\x9fh\xd2\xf0\x9f\xef+^\x96\xd6\xd4\x86\xb1j\xca\xc1\xa2\xe0\x98\x8f\xcb\xbdb\xa0\x81\xbf\xbe\xb3\xda\x8e1\xd1\xdd5\xbcbMz7\xce\xf3\x1eK\x88M(\\\x8b\xe0\xc5\xb3\xdaQ\x99\xf5\x12i\x10h\xec\x03+S\xdc\xfe\x07\x05\xf5\xa5\xf8\xc1,\x90\x94\x17\x81\top\x7f\x91\x1f\xd0\xe9\xb0K\xcd\xa9q\x0b\x00\x9fV\xa8\x94\x1d\xb2\xaf\x81\xcf\xa3\x9d\xfe5\xa0h\xe1\x14\xffkM\xd4-\x87\xffc@\x0c\x1bPS\xa4\xf2<u\xbeP\x10\x83\'me?\xfdl\xfe\xd1\xdar\xc7\x1b\x81~E\x97\xa2&[a\xa9\xbc/XsQ\xffR\xdc\x89\x98\x1c\xe4\xa9\x96$\x83\xe1\xb3xfz<\x8dpf\xfc7 \xf1\xb5\xf6c\xac\xf3u\xcf\xdf\xf0\x8aK\xa9\xf7\xa0\xd4\xf7\xf5x\x0f\xd5\xda\\\xfe\xeb{y\xaa;\xe9b\x93i\xcc\n\x07b\xffh\xa4d\xfc\x9b\x85\xf1z\xf4\x16v\xa8)\xb7df\x02)\x1eQ\xe1~\xe4(E/\x1bB\x00\xbb\x82\x1e\xf7\x16\x01H\x0eX\x10\x13\xe2\x9b\x98sHiw\xca\xbb\x12D]\r\xa2\xfa-\xaa\xae\xf3\x13u\xf9\x9e\xaa\\Mz\xdfG\x94\xadP.\xce\xf3\x17\xe6\x8f\xd70\xf8p\xd4\x86\x83qk\xd2\x93<<\xd2\xee\xbbe\x99#M"\x0b"\xff\xdb\xba;oJk\xa4k\xde\xeb\xc1\x8a\xc2\xfa\x07\\\tb\xe8(\xd5\xac\x1e\xe1w7\x93\x8f,^\xa9[\xf6+\x13\x8ac\xd2h,\xaen\xfd\xb4\xdb\xd6\x19\xe0\x175\x86\x88\xa8\xa3n^\x8c]\x85\xa93}/X\xbc\xef>\xcaOI\xe7|0\xb4\xc4+\xb1\xc6\xa4\x87\xaa\x96\xeb\xe5g\x02\xa0\xac\xb8\'\x91\xdb\xeb\t\xe4\xb82nH\xc5\xfc\x1b\x1f9nj\x15\xa9\xf9\xcdO\x9f\x1e&7\xf4@\x1a\xea\xba\xfa\x15\xed\xc12\xad\xd5\xbe8\xf0z\xdc\xac\xfd\xacP\xe4-\xf8=\xc6RV\x82\xb78\x0bR/\xb9\x0f\x9fe<\x01C\tP\xa0\xb3\xc7<\xa9\xcb\xf86w{A\xeb\x9f1\x89\x9f\x1c\xc5Zg=|"D\x9fyZ\x91\xac\x9d\x12\xbe\x96\xe62\xe3\xd5@\x8f\xc3\x17\x85\x9f\xf3\x9a\x15\x06$)\x99=\xfb\xc4\x97\xa8J\x91x\x05\xa4\x04\xc5W\x1d\xe1:ui\xa0L\xd0\xc8R\xec\x9b\xecC\xd9\xd3\xedoK\x87K\xdda\xec\xb3\x94)\xdd\xd5=\xf7\x0b\x16\xddyp\xf3\xf7#\x15\'\xe6\x8d\xab\xd6tM\x04F4o\xd2\xda=G\x96/\xe8\xda\x01\n\x10\xc7\xf3\xf7\x80r\xf5\xe3r\xb7\x1e\x080i\x0c\xca(\xcc\xaa\xc8\xa23\xfe\x00\x0cp\x10K\x91\x06\xdf\r\x99\xea\xfa\x99;"\x00\xec\x18\x87\xaeJ\x13\x1fa\xeb\xe5\x13B"\x1c\xac\xf7\xdd\xd0\xd2\x1a\xf1\xc5\xe9\xa5PY~u\x84\xa7"\xf43\xbao\xdb\xf1\xf2\xc4l{\x9b\x95\x9fs\xaf\xd8\x82I\xe2\xa3\x1c\xeb\x80\x16\\\x8c\xdb\xc7\xe9\xb002\x0b\x9f-\xf6\xe1X\xf8\x9a!\xd3\xeb\xcc\xd3H\xd5\x17\xd8\xc1\'sx\xaa\x05\x0e\x88\xa4\n\xa0\x19\xd2\xa4\xcb\xe8HL\x8cM\xeb\xe3\xe0\xe3i\xe3*\x18E\xca\x81\x11^\xe9\xfb\x1e\x8b\x9c\x9bY\xbfz\x16wD\xf5\x1b\xa9of<\xbf#\xd7\x85\xb54\xdep\xc69\xf3\x10\x8c\x98p\x96\xdbDE\x86\xbb\x9e\x1b\x92H\xf1n\x19e\x1d\xafkAY\xc0\xafd\x0e7\xdf\xf7\xf6\x80n\xa6\x9a\x89-\x90I\xb0\x01\x04\xd6\x8b\xd5\xa7Ys\xc8\xe0:o\xb3\xda\x8a]\xf2\x04\x16\x1f{\xb9\x96a\xaf\xe57,\xeb\xec0K\x16\x92\xca\xf2rf\xf6\xdf\x83\xa3\x8d\x12\xdf\'\x9a\xfaX\x9a!V\x05\xfb4*\x07!"\xbf\xdd%%\xd9~\xa4.\xea\xf44\x1b&%\xa7\xb3\x82\xfd\xeb\x99\xc17 \xa7_\x1e\x91\xbd\xff\xb6\t\xf6\x08l\x90\xe6\xd9\xe3#_\x972\xbeG\xd4v\xc5\x9f\x07\xea\xb6\x1e\xb9!wMIjq\x8d\x91j`&\xb3_+\x0f8\x91\x95\xd4jz\xd1\xca\x1b\xcc\x11\xc4#\x16bX\xe81\x00hy\x0b\x1e\xa0\x10\xfc\xe3{M\x15\x06q\x15::V\nK\x8aOsG\xa4\x81\x13\xd8|\xee_\xc7\xf9\x10m\xf8\xca\xc1\xbf\xb3\xbe\x92\x13\xbe\x9b\x9dv2\xe3\xa1\xa7m$b\x8ej*i\t\'n\xf6sbx\xc6E7\x16\x1c\xf86u\x1b\x82\xed^\xa7\x1e\x9e\x07Ys<\xe5\xfb;\xd5]C\x94\xadb\x82\xaa\xab\xab4_\xd81J\x92\xc6\xc8\x06\xd6>\xf4\xa2 \x8a1\xd2\xbbX\x13\xc0^f;\xec~\xde\xffi2\xa3\x875\xd6\x8e\x0c\x17\xf3\xe67y\xc2\xde\x1d\xb8\xb1h=\x90\xc8\x100l\xc3\xf6I\xde\xb2\xfc1K7\xf0\xac\x86%\xa8\xc6\\\x969\xd7\xc1\x15H\xe5\x17\xdcT=\xede\xf2\x1d\x077\xe8\xcdf\xcb%\x8a\xe0\x82Qh\xd5F_\x8eJ\x98\x14\xea\xa4l\x0e\xbevb\xed\xfb\xc6\xbfi\x7f]\r"^\x87):I\r\x97q\xdbC\xd6\xafd\xf5\xc4\xbbz\xfab\x10\x99\x87\x80\xfb\x06\x9dbM\xe9\x0eP\x12\x85D\xf7\xb7\x94J\x90\x81\x0c\x869-\xca3\xc1\x87\x88\xd2\xafyGE\xae\r\x15T\x8cr\xa5<\x84@nM\xb46l\xd4\xd3b\xed\t\xbcC\xd94\xdee\xc2\x91L\x8b\xe3"q\xf1c\x96l\x0fC;\xf5U\x11\x13`X\x9fo\xecCJC\xc7$\xb7\x87\x01\xa2D\xfcS\xdd\xb3\xfa\xb4f\xfa\x9a\xd8\xc9\xc0 \x1c9\\\xc8\xaa\xd6\x8b\x8a\x96h\xe1\xa4\x1f\xd6\xdd\xc5\xdc\xd4fO\xf4-\xfa\x17\xa3>#\x17s\xb1\xea\x14\xc0\xd9\x06\x04!\x1c\x8e\xc2\x13:\xce\x89r\x85\xbbys\xdd\xa1\xeajW4A\xdb\xac\x05\x81\xcf\xc6}\xb7\x1d\xfc\x1dg\x1c\xe8\xeab^\xc2\xd97\xee)\x90\xac\x0e\xbe\x9c\xa7c\x05x8\xa8\xea;Y\xe4\x17\x89\xc9\xfa\x99\xc4l\xa7d\tN6b^Fa\xcdEcZ&\x1d\x95R]~\x87l]\xf0m&\x9b\xc0\xfc]\x9ch\xd46drM\x84\x13\xf1\xb2\xf2~\xf9\x9f\xb5\xfc\x0b:\xdd2\xb8\x08\xf22j$Gw\xce\xbf\r\xd1\x07\xccJy!qMN\x8e\x85h\xb9\xf5n:\xad\x17\xfa=\x9dS\xf6h\xd4f\xe3M#!\xd2\xd4\xa8M\x98\xec\xd1\xa5\xb2\x11\x8e\xe0M\x82A\xda3\xa9K\x16\xffI\xd6j|\xabg\xe9\x9e?\x11\x1cwq\xbe\x03\x93\xb3DD\x12\xa9)\xbd\xa3\xfdD\x9d\x99\xf7\x0bu\xf2\x9f\xf0\xa3+\x01\xb2\xe1_h\x84\x1a\xafBiZ_*\x8f\\j\xb9K\x94\xe9\xb7\xa1v\x87\xd1\x9a\x0b\xf2\xf1*(O\x91\xeb,(T>\x12l\x0b\xefd\x89q\xb7\x94\xff<C\x96\x01\xce\x07\xe82J\xa4\x01\xc1 \x88J\x8b\xf6\xd84\x06\xb35\x92m\x85:\xd5\xd5C\xa9\xa2~t\xd3\xa3\x94\xfe_\xa3_/\xb7\xc4O.F\xd24Y2`!\xc0\xcd\'q\xa4\xb0\xfc\'2k\xfe\xb0M\x03>)B]\xee]\x07S0\x9b\t\x84\x9dO\t\xb2=|\xfdA{\xf8\xc2\xa2.\xb1\xb2\x1b\xf5\x9a\xf1}\xd6\xc2M\x12\xb3w\xae\x97iW\xe6\xa2\xf4!\xa5\x0fs\xfb\x99Q\xe2\xfb\\\xa3b\x82\x0b\x15@\x19\xd6\xdf\xe75\x9c`1\xa5\x88D\x1dq\xdc,=\x84\xae\xd6\rd\xf8^{\xf6\x8c\xd6OS8&\x0c^<]\xca\xf6n\xf2\xabB\xb6w\xe2=\xc3V\xf6\xcfM\xa0]y\x96=)\xd3\xac\x89\xbc\x95\x0c\x0e\xf8OSH\xa5\xc1\nZ\x7f6\xb20\xaeb\x12Yr\xa4\x13\x86\xf8%\x9c\xc7Al\'\x0b\x17./\x00\xf8nwzA\xdb\x06EM\x114\x1e\xc0\xe3v\xb8\x89,3\x83\x06\x0b\x14y\xfcj\xd4n3\xde<R\x83M\x89\xe9dU\x85^\x064\x1b\x97E\xf2L\xe2\x1b2\xed\x0fy\xea\xfc\xe3qMg\x99\xf3\x89b\xb4\xbf^8N\xea\x89`@\xb9\xb3Bt0\xa3[T;R\xabF\xdfMy\xe9V\xd0\x04\xa3$_\xcf\x99#\xc1T\xb0\\K\xf2\xa3{\\d\xb3\x98\xf6\xf3\xf9\xecM\xf6\xeb\xa8M\xc7\xc6\xce\x8b\xba\xc1\xd7\xf0\x9e\xc2b\x12\x9cbV\x01\x07i\x15z-\xdaM\x11\xa8\xd5\xc6\x1e\xb9\xc8\x0f\xa6S\xa4N\x08\x82eZ=\xf0\xfb-a\x1fa\'\xa7p\x83\xcc.P\x11\xe9\x1f\x11Z\xbf\x89\xb1\x04\r7&\x8f*\x94C\xb2\xccC\x92h\x1b-l\'\xe8\xd7\xbc-\x8f\xe2\xaa \x13\x8e\xc6%_>\xba:\xd2.ph\x06\x8eQ[\x93\x03\x10\x7f\xae\x87\xa5\x08\x1aL\x10\x9e\xf0O\xb1\xb7*RJj\xc9\x86\xc2\x06*\x0eH\x84B\xd6N\x8c&:aC\xb6\xe6\xe2n*w\xb3\x06Z\xc5\xaa\xef\x86\xd0*\xaf\xf0P\xd9\xfd\x166\xc4w\xf9\x84\xcc) \x9eh \x00\t\xd0\xc9\x8e`jA\xb6*\x1a\x17\xf6>\x0e\n\x1b\xa1\x81e\xde\r\xf0\x92\x1a\x8e\xcf\xbdC\xbe\x9c\x8c\x9c\xff\xd5\x07\x14^\xd1\xd6G3O\xa1\x92}\x0f\xa2\x838\x1b\x1b\xf9$\xf9\xacR\x89I\xf9\x16ZV$*\n\xad\xe3\xac\xca \x16\x93\xb1Y*\xa3\x1e\x8c\xbd\xca\x81\x7fd1\xa2""\xca\xaeR=\xc0\x87\x8c\xca\xd5\x87\xd3\xabG\rWJa\t=J8\xcemQ{\xbd\xc5\x96\xe6\xe0eTe\x9cJ?\x04\x02(\xff\xd08<\xff\x9f\x80\xeb\xb5`\xc2\xf2\x05\x8c1\xfd\x9c1;\xb1\xc2\x96\x18\'\xb92>\xff\xd0\xc0\xd7J\x08a+\xaa\xa6\xfb\x89S\xad\xfa\'\x8e\xc3]1\x06d\xe7\xdb\x89B\xd6\x89\x86\xc1g\xa3\xad"\xc3\xf3\xde\xc7T\x80\xb7\xc2Z\rl\x95k\xbd!\xf9\xdc\xf4B\x91"W|\x15o\xb7\xb3\xe9ci\xbb"\xf3(\xe0O\xc8\xa3\xe9J\x9fFUa\r\x89\x87\x91\x87\x1fe\xfb\xdf\xe14\rJ\xf5,\xa4\x80\xe8#\x8d\x8d\xf9M\xf1\x14\xf1\xdd')
passwordHash = "e078eb31da8d9cee675783ec99c0ea2955472744bf7a95e26a44ce906c8e21c8"

brokenPassword = ["I", "Den", "Verden", "Magnus", "Er", "Bedste", "Hele"]
password = "".join(brokenPassword)

if hashlib.sha256(password.encode()).hexdigest() != passwordHash:
    raise Exception("Wrong password!")

ht = dmca.BuildHashTable(password)

decrypted = dmca.Decrypt(encpryptedMessage, ht)
secretMessage = zlib.decompress(decrypted).decode()

for line in secretMessage.split("\n"):
    time.sleep(0.2)
    print(line)
